{
  "name": "Custom HTML Module",
  "code": "custom_html",
  "version": "1.0.0",
  "author": "Utility Libraries",
  "files": [
    {
      "path": "admin/view/template/setting/setting.twig",
      "operations": [
        {
          "search": "<li><a href=\"#tab-server\" data-toggle=\"tab\">{{ tab_server }}</a></li>",
          "add": {
            "position": "after",
            "content": "<li><a href=\"#tab-custom-html\" data-toggle=\"tab\">Custom HTML</a></li>"
          }
        },
        {
          "search": "<div class=\"tab-content\">",
          "add": {
            "position": "after",
            "content": "<div id=\"tab-custom-html\" class=\"tab-pane\"><div class=\"form-group\"><label class=\"col-sm-2 control-label\" for=\"input-html\">{{ entry_html }}</label><div class=\"col-sm-10\"><textarea name=\"custom_html_html\" rows=\"5\" placeholder=\"{{ entry_html }}\" id=\"input-html\" class=\"form-control\">{{ custom_html_html }}</textarea></div></div><div class=\"form-group\"><label class=\"col-sm-2 control-label\" for=\"input-page\">{{ entry_page }}</label><div class=\"col-sm-10\"><select name=\"custom_html_page\" id=\"input-page\" class=\"form-control\"><option value=\"all\" {{ custom_html_page == \"all\" ? \"selected\" : \"\" }}>{{ text_all_pages }}</option>{% for page in pages %}<option value=\"{{ page.name }}\" {{ custom_html_page == page.name ? \"selected\" : \"\" }}>{{ page.name }}</option>{% endfor %}</select></div></div><div class=\"form-group\"><label class=\"col-sm-2 control-label\" for=\"input-position\">{{ entry_position }}</label><div class=\"col-sm-10\"><select name=\"custom_html_position\" id=\"input-position\" class=\"form-control\"><option value=\"column_left\" {{ custom_html_position == \"column_left\" ? \"selected\" : \"\" }}>{{ text_column_left }}</option><option value=\"column_right\" {{ custom_html_position == \"column_right\" ? \"selected\" : \"\" }}>{{ text_column_right }}</option><option value=\"content_top\" {{ custom_html_position == \"content_top\" ? \"selected\" : \"\" }}>{{ text_content_top }}</option><option value=\"content_bottom\" {{ custom_html_position == \"content_bottom\" ? \"selected\" : \"\" }}>{{ text_content_bottom }}</option></select></div></div><button type=\"submit\" form=\"form-custom-html\" data-toggle=\"tooltip\" title=\"{{ button_save }}\" class=\"btn btn-primary\"><i class=\"fa fa-save\"></i></button></div>"
          }
        }
      ]
    },
    {
      "path": "admin/model/setting/setting.php",
      "operations": [
        {
          "search": "class ModelSettingSetting extends Model {",
          "add": {
            "position": "after",
            "content": "public function getPages() {$query = $this->db->query(\"SELECT name FROM \" . DB_PREFIX . \"layout\");return $query->rows;}"
          }
        }
      ]
    },
    {
      "path": "admin/controller/setting/setting.php",
      "operations": [
        {
          "search": "$this->response->setOutput($this->load->view('setting/setting', $data));",
          "add": {
            "position": "before",
            "content": "$this->load->model('setting/setting');$data['pages'] = $this->model_setting_setting->getPages();$data['custom_html_html'] = $this->config->get('custom_html_html');$data['custom_html_page'] = $this->config->get('custom_html_page');$data['custom_html_position'] = $this->config->get('custom_html_position');"
          }
        },
        {
          "search": "$this->model_setting_setting->editSetting('config', $this->request->post);",
          "add": {
            "position": "after",
            "content": "$this->model_setting_setting->editSetting('custom_html', ['custom_html_html' => $this->request->post['custom_html_html'],'custom_html_page' => $this->request->post['custom_html_page'],'custom_html_position' => $this->request->post['custom_html_position']]);"
          }
        }
      ]
    },
    {
      "path": "catalog/controller/common/column_left.php",
      "operations": [
        {
          "search": "return $this->load->view('common/column_left', $data);",
          "add": {
            "position": "before",
            "content": "$custom_html_html = $this->config->get('custom_html_html');$custom_html_page = $this->config->get('custom_html_page');$custom_html_position = $this->config->get('custom_html_position');$normalize_select_page = strtolower($custom_html_page);$is_all_page = $normalize_select_page == 'all';$is_home_page = !isset($this->request->get['route']) && $normalize_select_page === 'home';$is_select_page = !$is_home_page && strpos($this->request->get['route'], $normalize_select_page) !== false;$is_adding_html = $is_all_page || $is_home_page || $is_select_page;if ($custom_html_position === 'column_left' && $is_adding_html) {$data['modules'][] = html_entity_decode($custom_html_html, ENT_QUOTES, 'UTF-8');}"
          }
        }
      ]
    },
    {
      "path": "catalog/controller/common/column_right.php",
      "operations": [
        {
          "search": "return $this->load->view('common/column_right', $data);",
          "add": {
            "position": "before",
            "content": "$custom_html_html = $this->config->get('custom_html_html');$custom_html_page = $this->config->get('custom_html_page');$custom_html_position = $this->config->get('custom_html_position');$normalize_select_page = strtolower($custom_html_page);$is_all_page = $normalize_select_page == 'all';$is_home_page = !isset($this->request->get['route']) && $normalize_select_page === 'home';$is_select_page = !$is_home_page && strpos($this->request->get['route'], $normalize_select_page) !== false;$is_adding_html = $is_all_page || $is_home_page || $is_select_page;if ($custom_html_position === 'column_right' && $is_adding_html) {$data['modules'][] = html_entity_decode($custom_html_html, ENT_QUOTES, 'UTF-8');}"
          }
        }
      ]
    },
    {
      "path": "catalog/controller/common/content_top.php",
      "operations": [
        {
          "search": "return $this->load->view('common/content_top', $data);",
          "add": {
            "position": "before",
            "content": "$custom_html_html = $this->config->get('custom_html_html');$custom_html_page = $this->config->get('custom_html_page');$custom_html_position = $this->config->get('custom_html_position');$normalize_select_page = strtolower($custom_html_page);$is_all_page = $normalize_select_page == 'all';$is_home_page = !isset($this->request->get['route']) && $normalize_select_page === 'home';$is_select_page = !$is_home_page && strpos($this->request->get['route'], $normalize_select_page) !== false;$is_adding_html = $is_all_page || $is_home_page || $is_select_page;if ($custom_html_position === 'content_top' && $is_adding_html) {$data['modules'][] = html_entity_decode($custom_html_html, ENT_QUOTES, 'UTF-8');}"
          }
        }
      ]
    },
    {
      "path": "catalog/controller/common/content_bottom.php",
      "operations": [
        {
          "search": "return $this->load->view('common/content_bottom', $data);",
          "add": {
            "position": "before",
            "content": "$custom_html_html = $this->config->get('custom_html_html');$custom_html_page = $this->config->get('custom_html_page');$custom_html_position = $this->config->get('custom_html_position');$normalize_select_page = strtolower($custom_html_page);$is_all_page = $normalize_select_page == 'all';$is_home_page = !isset($this->request->get['route']) && $normalize_select_page === 'home';$is_select_page = !$is_home_page && strpos($this->request->get['route'], $normalize_select_page) !== false;$is_adding_html = $is_all_page || $is_home_page || $is_select_page;if ($custom_html_position === 'content_bottom' && $is_adding_html) {$data['modules'][] = html_entity_decode($custom_html_html, ENT_QUOTES, 'UTF-8');}"
          }
        }
      ]
    },
    {
      "path": "admin/language/en-gb/setting/setting.php",
      "operations": [
        {
          "search": "$_['entry_status']",
          "add": {
            "position": "after",
            "content": "$_['entry_html'] = 'Custom HTML';$_['entry_page'] = 'Select Page';$_['entry_position'] = 'Position';$_['text_all_pages'] = 'All Pages';$_['text_column_left'] = 'Column Left';$_['text_column_right'] = 'Column Right';$_['text_content_top'] = 'Content Top';$_['text_content_bottom'] = 'Content Bottom';$_['button_save'] = 'Save';"
          }
        }
      ]
    }
  ]
}
